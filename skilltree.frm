VERSION 5.00
Begin VB.Form Form9 
   Caption         =   "Form9"
   ClientHeight    =   8715
   ClientLeft      =   60
   ClientTop       =   510
   ClientWidth     =   12000
   LinkTopic       =   "Form9"
   ScaleHeight     =   581
   ScaleMode       =   3  'Pixel
   ScaleWidth      =   800
   StartUpPosition =   2  'CenterScreen
   Begin VB.CommandButton Command1 
      Caption         =   "Command1"
      Height          =   1500
      Index           =   35
      Left            =   6960
      Style           =   1  'Graphical
      TabIndex        =   37
      Top             =   7200
      Visible         =   0   'False
      Width           =   1350
   End
   Begin VB.CommandButton Command1 
      Caption         =   "Command1"
      Height          =   1500
      Index           =   34
      Left            =   6960
      Style           =   1  'Graphical
      TabIndex        =   36
      Top             =   5760
      Visible         =   0   'False
      Width           =   1350
   End
   Begin VB.CommandButton Command1 
      Caption         =   "Command1"
      Height          =   1500
      Index           =   33
      Left            =   6960
      Style           =   1  'Graphical
      TabIndex        =   35
      Top             =   4320
      Visible         =   0   'False
      Width           =   1350
   End
   Begin VB.CommandButton Command1 
      Caption         =   "Command1"
      Height          =   1500
      Index           =   32
      Left            =   6960
      Style           =   1  'Graphical
      TabIndex        =   34
      Top             =   2880
      Visible         =   0   'False
      Width           =   1350
   End
   Begin VB.CommandButton Command1 
      Caption         =   "Command1"
      Height          =   1500
      Index           =   31
      Left            =   6960
      Style           =   1  'Graphical
      TabIndex        =   33
      Top             =   1440
      Visible         =   0   'False
      Width           =   1350
   End
   Begin VB.CommandButton Command1 
      Caption         =   "Command1"
      Height          =   1500
      Index           =   30
      Left            =   6960
      Style           =   1  'Graphical
      TabIndex        =   32
      Top             =   0
      Visible         =   0   'False
      Width           =   1350
   End
   Begin VB.CommandButton Command1 
      Caption         =   "Command1"
      Height          =   1500
      Index           =   29
      Left            =   5640
      Style           =   1  'Graphical
      TabIndex        =   31
      Top             =   7200
      Visible         =   0   'False
      Width           =   1350
   End
   Begin VB.CommandButton Command1 
      Caption         =   "Command1"
      Height          =   1500
      Index           =   28
      Left            =   5640
      Style           =   1  'Graphical
      TabIndex        =   30
      Top             =   5760
      Visible         =   0   'False
      Width           =   1350
   End
   Begin VB.CommandButton Command1 
      Caption         =   "Command1"
      Height          =   1500
      Index           =   27
      Left            =   5640
      Style           =   1  'Graphical
      TabIndex        =   29
      Top             =   4320
      Visible         =   0   'False
      Width           =   1350
   End
   Begin VB.CommandButton Command1 
      Caption         =   "Command1"
      Height          =   1500
      Index           =   26
      Left            =   5640
      Style           =   1  'Graphical
      TabIndex        =   28
      Top             =   2880
      Visible         =   0   'False
      Width           =   1350
   End
   Begin VB.CommandButton Command1 
      Caption         =   "Command1"
      Height          =   1500
      Index           =   25
      Left            =   5640
      Style           =   1  'Graphical
      TabIndex        =   27
      Top             =   1440
      Visible         =   0   'False
      Width           =   1350
   End
   Begin VB.CommandButton Command1 
      Caption         =   "Command1"
      Height          =   1500
      Index           =   24
      Left            =   5640
      Style           =   1  'Graphical
      TabIndex        =   26
      Top             =   0
      Visible         =   0   'False
      Width           =   1350
   End
   Begin VB.CommandButton Command1 
      Caption         =   "Command1"
      Height          =   1500
      Index           =   18
      Left            =   4320
      Style           =   1  'Graphical
      TabIndex        =   19
      Top             =   7200
      Visible         =   0   'False
      Width           =   1350
   End
   Begin VB.CommandButton Command1 
      Caption         =   "Command1"
      Height          =   1500
      Index           =   19
      Left            =   4320
      Style           =   1  'Graphical
      TabIndex        =   20
      Top             =   5760
      Visible         =   0   'False
      Width           =   1350
   End
   Begin VB.CommandButton Command1 
      Caption         =   "Command1"
      Height          =   1500
      Index           =   20
      Left            =   4320
      Style           =   1  'Graphical
      TabIndex        =   21
      Top             =   4320
      Visible         =   0   'False
      Width           =   1350
   End
   Begin VB.CommandButton Command1 
      Caption         =   "Command1"
      Height          =   1500
      Index           =   21
      Left            =   4320
      Style           =   1  'Graphical
      TabIndex        =   22
      Top             =   2880
      Visible         =   0   'False
      Width           =   1350
   End
   Begin VB.CommandButton Command1 
      Caption         =   "Command1"
      Height          =   1500
      Index           =   22
      Left            =   4320
      Style           =   1  'Graphical
      TabIndex        =   23
      Top             =   1440
      Visible         =   0   'False
      Width           =   1350
   End
   Begin VB.CommandButton Command1 
      Caption         =   "Command1"
      Height          =   1500
      Index           =   23
      Left            =   4320
      Style           =   1  'Graphical
      TabIndex        =   24
      Top             =   0
      Visible         =   0   'False
      Width           =   1350
   End
   Begin VB.CommandButton Command1 
      Caption         =   "Command1"
      Height          =   1500
      Index           =   17
      Left            =   3000
      Style           =   1  'Graphical
      TabIndex        =   18
      Top             =   7200
      Visible         =   0   'False
      Width           =   1350
   End
   Begin VB.CommandButton Command1 
      Caption         =   "Command1"
      Height          =   1500
      Index           =   16
      Left            =   3000
      Style           =   1  'Graphical
      TabIndex        =   17
      Top             =   5760
      Visible         =   0   'False
      Width           =   1350
   End
   Begin VB.CommandButton Command1 
      Caption         =   "Command1"
      Height          =   1500
      Index           =   15
      Left            =   3000
      Style           =   1  'Graphical
      TabIndex        =   16
      Top             =   4320
      Visible         =   0   'False
      Width           =   1350
   End
   Begin VB.CommandButton Command1 
      Caption         =   "Command1"
      Height          =   1500
      Index           =   14
      Left            =   3000
      Style           =   1  'Graphical
      TabIndex        =   15
      Top             =   2880
      Visible         =   0   'False
      Width           =   1350
   End
   Begin VB.CommandButton Command1 
      Caption         =   "Command1"
      Height          =   1500
      Index           =   13
      Left            =   3000
      Style           =   1  'Graphical
      TabIndex        =   14
      Top             =   1440
      Visible         =   0   'False
      Width           =   1350
   End
   Begin VB.CommandButton Command1 
      Caption         =   "Command1"
      Height          =   1500
      Index           =   12
      Left            =   3000
      Style           =   1  'Graphical
      TabIndex        =   13
      Top             =   0
      Visible         =   0   'False
      Width           =   1350
   End
   Begin VB.CommandButton Command1 
      Caption         =   "Command1"
      Height          =   1500
      Index           =   11
      Left            =   1680
      Style           =   1  'Graphical
      TabIndex        =   12
      Top             =   7200
      Visible         =   0   'False
      Width           =   1350
   End
   Begin VB.CommandButton Command1 
      Caption         =   "Command1"
      Height          =   1500
      Index           =   10
      Left            =   1680
      Style           =   1  'Graphical
      TabIndex        =   11
      Top             =   5760
      Visible         =   0   'False
      Width           =   1350
   End
   Begin VB.CommandButton Command1 
      Caption         =   "Command1"
      Height          =   1500
      Index           =   9
      Left            =   1680
      Style           =   1  'Graphical
      TabIndex        =   10
      Top             =   4320
      Visible         =   0   'False
      Width           =   1350
   End
   Begin VB.CommandButton Command1 
      Caption         =   "Command1"
      Height          =   1500
      Index           =   8
      Left            =   1680
      Style           =   1  'Graphical
      TabIndex        =   9
      Top             =   2880
      Visible         =   0   'False
      Width           =   1350
   End
   Begin VB.CommandButton Command1 
      Caption         =   "Command1"
      Height          =   1500
      Index           =   7
      Left            =   1680
      Style           =   1  'Graphical
      TabIndex        =   8
      Top             =   1440
      Visible         =   0   'False
      Width           =   1350
   End
   Begin VB.CommandButton Command1 
      Caption         =   "Command1"
      Height          =   1500
      Index           =   6
      Left            =   1680
      Style           =   1  'Graphical
      TabIndex        =   7
      Top             =   0
      Visible         =   0   'False
      Width           =   1350
   End
   Begin VB.CommandButton Command1 
      Caption         =   "Command1"
      Height          =   1500
      Index           =   5
      Left            =   120
      Style           =   1  'Graphical
      TabIndex        =   6
      Top             =   7200
      Visible         =   0   'False
      Width           =   1350
   End
   Begin VB.CommandButton Command1 
      Caption         =   "Command1"
      Height          =   1500
      Index           =   4
      Left            =   120
      Style           =   1  'Graphical
      TabIndex        =   5
      Top             =   5760
      Visible         =   0   'False
      Width           =   1350
   End
   Begin VB.CommandButton Command1 
      Caption         =   "Command1"
      Height          =   1500
      Index           =   3
      Left            =   120
      Style           =   1  'Graphical
      TabIndex        =   4
      Top             =   4320
      Visible         =   0   'False
      Width           =   1350
   End
   Begin VB.CommandButton Command1 
      Caption         =   "Command1"
      Height          =   1500
      Index           =   2
      Left            =   120
      Style           =   1  'Graphical
      TabIndex        =   2
      Top             =   2880
      Visible         =   0   'False
      Width           =   1350
   End
   Begin VB.CommandButton Command1 
      Caption         =   "Command1"
      Height          =   1500
      Index           =   1
      Left            =   120
      Style           =   1  'Graphical
      TabIndex        =   1
      Top             =   1440
      Visible         =   0   'False
      Width           =   1350
   End
   Begin VB.CommandButton Command1 
      Caption         =   "Command1"
      Height          =   1500
      Index           =   0
      Left            =   120
      Style           =   1  'Graphical
      TabIndex        =   0
      Top             =   0
      Visible         =   0   'False
      Width           =   1350
   End
   Begin VB.Label Label2 
      BeginProperty Font 
         Name            =   "MS Sans Serif"
         Size            =   13.5
         Charset         =   0
         Weight          =   400
         Underline       =   0   'False
         Italic          =   0   'False
         Strikethrough   =   0   'False
      EndProperty
      Height          =   855
      Left            =   8400
      TabIndex        =   25
      Top             =   7800
      Width           =   3615
   End
   Begin VB.Label Label1 
      BeginProperty Font 
         Name            =   "MS Sans Serif"
         Size            =   13.5
         Charset         =   0
         Weight          =   700
         Underline       =   0   'False
         Italic          =   -1  'True
         Strikethrough   =   0   'False
      EndProperty
      Height          =   7575
      Left            =   8400
      TabIndex        =   3
      Top             =   120
      Width           =   3375
   End
End
Attribute VB_Name = "Form9"
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = False
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = False
Private Type skbuttnt
    skillname As String
    caption As String
    image As String
    requires As String
    requires2 As String
End Type

Dim lastskill As Integer
Dim skilltree(50) As skbuttnt
Dim butnarray(45) As Byte
'Dim sbutnarray(5) As Byte

Sub updatbuttnz()

If plr.skillpoints = 0 And totalskills = 0 Then plr.skillpoints = plr.level * 4
'chars(CurChar).skillpoints = chars(CurChar).level - totalskills
lastskill = 0

createskill "Deathblow", "sword", "Adds 10% damage, +5% per skill level"
createskill "Critical Strike", "skull", "10% chance to inflict double damage. Chance increases by 3% per level."
createskill "Resilience", "circleplus", "-3 points of damage from incoming attacks, plus -2 per level"
createskill "Defence", "circleplusblue", "+15% to armor, +5% per level"
createskill "Evasion", "triangleblue", "-2 to enemy to-hit rolls, -1 per level."
createskill "Dodge", "splatterblue", "5% chance to dodge incoming attacks, +2% per level"
createskill "Endurance", "heartorange", "+2 HP for every character level, +1 per skill level"
createskill "Squirm", "splatterorange", "Increases chance of escaping from monster's stomachs"
createskill "Drain Life", "heartdrip", "Gain 1% of damage when hitting enemies, +0.5% per level"
createskill "Drain Magic", "heartdripblue", "Convert 1% of the damage you inflict on enemies into mana, +0.5% per level"
createskill "Regeneration", "plus", "Regenerate HP over time. Rate increases with skill level."
createskill "Firepower", "firepower", "Increases damage done with direct attack spells. +10% base, +5% per level."
createskill "Accuracy", "swordblue", "Increases chances to hit with melee weapons. +2 base, +1 per level."
createskill "Greed", "cash", "+10% to gold collected, +4% per level"
createskill "Spell Mastery", "trianglefire", "Spells cost 10% less mana to cast, +3% per level."
createskill "Mana Mastery", "manafire", "+2 mana per character level, +1 per skill level."
createskill "Mana Regeneration", "heartblue", "Increases mana regeneration rate."
'createskill "White Magic Mastery", "heart", "Increases effectiveness of white spells by 10% plus 3% per level."
'createskill "Grey Magic Mastery", "trianglemagic", "Increases effectiveness of grey spells by 10% plus 3% per level."
'createskill "Black Magic Mastery", "skullfire", "Increases effectiveness of black spells by 10% plus 3% per level."
createskill "Streetfighting", "fists", "Increases unarmed damage by 30%, plus 15% per level."
createskill "Weapons Mastery", "swordgrey", "Increases all weapon damage by 20%, plus 6% per level."


createskill "Giant Stomach", "stomach", "Allows you to eat monsters!  Higher levels allow you to hold more monsters in your stomach at a time.  1 monster base, +1 monster per skill level." & vbCrLf & "(Press 'E' before attacking something to attempt to eat it)"
createskill "Super Acid", "stomachacid", "Increases the speed at which you digest monsters and the damage they take while in your stomach."
createskill "Gluttony", "mouth", "Increases your chance of successfully swallowing monsters."

createskill "Sword Mastery", "swordmastery", "Increases damage inflicted by sword and knife type weapons.  +2 per die per level."
createskill "Spear Mastery", "spearmastery", "Increases damage inflicted by spear type weapons.  +3 per die per level."
createskill "Axe Mastery", "axemastery", "Increases damage inflicted by axe and mace type weapons.  +2 per die per level."
createskill "Bow Mastery", "bowmastery", "Increases damage inflicted by bow type weapons.  +20% per level."
createskill "White Magic", "whitemagic", "Increases power of white spells and gives access to new white spells.  White spells focus on healing and protection."
createskill "Grey Magic", "greymagic", "Increases power of grey spells and gives access to new grey spells."
createskill "Fire Magic", "firemagic", "Increases power of fire spells and gives access to new fire spells.  Fire spells are largely offensive attack spells with a high damage rating."
createskill "Air Magic", "lightningmagic", "Increases power of air spells and gives access to new air spells.  Air magic gives good offensive spells with some basic defensive spells."
createskill "Water Magic", "watermagic", "Increases power of water spells and gives access to new water spells.  Water magic focuses on enchantment, healing, and exotic abilities."
createskill "Earth Magic", "earthmagic", "Increases power of earth spells and gives access to new earth spells.  Earth magic gives powerful defensive and combat abilities, but has no direct attack spells."
createskill "Demon Summoning", "demonsummoning", "Increases the power of summoned demons and gives you the ability to summon more."
createskill "Sorcery", "sorcery", "'Basic' magic.  Gives a broad range of spells and abilities that increase your magical powers."
'createskill "Magic Summoning", "magicsummoning", "Gives you the ability to summon a magical creature to aid you."

For a = 1 To 4
    Select Case plr.combatskills(a)
        Case "Cripple": createskill "Cripple", "cripple", "Inflicts 25% damage on the first hit, +4% per level"
        Case "Frenzy": createskill "Frenzy", "frenzy", "Attacks 1 extra nearby enemy per level"
        Case "Split Spell": createskill "Split Spell", "splitspell", "Adds 80% to the mana cost of a spell and doubles the number of bolts it fires"
        Case "Stun": createskill "Stun", "stun", "Has a chance to stun enemies.  Increased skill increases chances and duration of stun."
        Case "Charged Strike": createskill "Charged Strike", "chargedstrike", "Adds 50% damage, +25% per level"
        Case "Power Strike": createskill "Power Strike", "powerstrike", "Adds (Strength times Weapon Dice times skill level) to damage"
        Case "Vital Strike": createskill "Vital Strike", "vitalstrike", "Adds (Dexterity times Weapon Dice times skill level) to damage"
        Case "Cunning Strike": createskill "Cunning Strike", "cunningstrike", "Adds (Intelligence times Weapon Dice times skill level) to damage"
        Case "Mana Shield": createskill "Mana Shield", "manashield", "Half damage is absorbed by mana, with a 10% reduction in damage taken to mana per level"
        Case "Block": createskill "Block", "block", "Damage reduced by 25%, +2% per level"
        Case "Damage Energy": createskill "Damage Energy", "damageenergy", "You get an amount of mana equal to 20% of the damage you take, +10% per level"
        Case "Poisonous": createskill "Poisonous", "poisonous", "Monsters take damage when they try to digest you"
        Case "Alchemy": createskill "Alchemy", "alchemy", "Gain three points of mana plus two per level every turn at the flat cost of 2 goldpieces per turn"
        Case "Split Arrow": createskill "Split Arrow", "splitarrow", "Fire one extra arrow per level"
        Case "Piercing Arrow": createskill "Piercing Arrow", "piercingarrow", "Arrows pierce up to 3 enemies, +1 per dice to damage per level"
        Case "Perfect Strike": createskill "Perfect Strike", "perfectstrike", "Attacks automatically inflict maximum damage, +5% per level."
        Case "Reflection": createskill "Reflection", "reflection", "Reflects weapons back at their firer, multiplying their damage by your level in the reflection skill."
        Case "Vicious": createskill "Vicious", "vicious", "Significantly increases damage against more dangerous enemies, based on your relative levels and the level of Vicious you have.  (Roughly +20%-30% per level they have over you, +15% per vicious level)"
    End Select
Next a


lastbutn = 6
    lastcbutn = 0

For a = 0 To lastskill - 1
    
    If ifclassskill(skilltree(a).skillname) = True Then
    butnarray(lastcbutn) = a
    createbutn a, Command1(lastcbutn): lastcbutn = lastcbutn + 1
    Else:
    butnarray(lastbutn) = a
    createbutn a, Command1(lastbutn): lastbutn = lastbutn + 1
    End If
'    lastbutn = a - 1
'    If chars(CurChar).classskills(a) = "" Then GoTo 5
'    For b = 0 To 50
'    If skilltree(b).skillname = chars(CurChar).classskills(a) Then createskill skilltree(b).skillname, skilltree(b).image, skilltree(b).caption, skilltree(b).requires, skilltree(b).requires2
'    Next b
Next a

Label2.caption = "Skill Points:" & plr.skillpoints & vbCrLf & "Combat Skill Points:" & plr.combatskillpoints

End Sub

Sub updatbuttnz_new()
'm'' this is the original Duam sub.

If chars(CurChar).skillpoints = 0 And totalskills = 0 Then chars(CurChar).skillpoints = chars(CurChar).level * 4
'chars(CurChar).skillpoints = chars(CurChar).level - totalskills
lastskill = 0

createskill "Deathblow", "sword", "Adds 10% damage, +5% per skill level"
createskill "Critical Strike", "skull", "10% chance to inflict double damage. Chance increases by 3% per level."
createskill "Resilience", "circleplus", "-3 points of damage from incoming attacks, plus -2 per level"
createskill "Defence", "circleplusblue", "+15% to armor, +5% per level"
createskill "Evasion", "triangleblue", "-2 to enemy to-hit rolls, -1 per level."
createskill "Dodge", "splatterblue", "5% chance to dodge incoming attacks, +2% per level"
createskill "Endurance", "heartorange", "+2 HP for every character level, +1 per skill level"
createskill "Squirm", "splatterorange", "Increases chance of escaping from monster's stomachs"
createskill "Drain Life", "heartdrip", "Gain 1% of damage when hitting enemies, +0.5% per level"
createskill "Drain Magic", "heartdripblue", "Convert 1% of the damage you inflict on enemies into mana, +0.5% per level"
createskill "Regeneration", "plus", "Regenerate HP over time. Rate increases with skill level."
createskill "Firepower", "firepower", "Increases damage done with direct attack spells. +10% base, +5% per level."
createskill "Accuracy", "swordblue", "Increases chances to hit with melee weapons. +2 base, +1 per level."
createskill "Greed", "cash", "+10% to gold collected, +4% per level"
createskill "Spell Mastery", "trianglefire", "Spells cost 10% less mana to cast, +3% per level."
createskill "Mana Mastery", "manafire", "+2 mana per character level, +1 per skill level."
createskill "Mana Regeneration", "heartblue", "Increases mana regeneration rate."
'createskill "White Magic Mastery", "heart", "Increases effectiveness of white spells by 10% plus 3% per level."
'createskill "Grey Magic Mastery", "trianglemagic", "Increases effectiveness of grey spells by 10% plus 3% per level."
'createskill "Black Magic Mastery", "skullfire", "Increases effectiveness of black spells by 10% plus 3% per level."
createskill "Streetfighting", "fists", "Increases unarmed damage by 30%, plus 15% per level."
createskill "Weapons Mastery", "swordgrey", "Increases all weapon damage by 20%, plus 6% per level."


createskill "Giant Stomach", "stomach", "Allows you to eat monsters!  Higher levels allow you to hold more monsters in your stomach at a time.  1 monster base, +1 monster per skill level." & vbCrLf & "(Press 'E' before attacking something to attempt to eat it)"
createskill "Super Acid", "stomachacid", "Increases the speed at which you digest monsters and the damage they take while in your stomach."
createskill "Gluttony", "mouth", "Increases your chance of successfully swallowing monsters."

createskill "Sword Mastery", "swordmastery", "Increases damage inflicted by sword and knife type weapons.  +2 per die per level."
createskill "Spear Mastery", "spearmastery", "Increases damage inflicted by spear type weapons.  +3 per die per level."
createskill "Axe Mastery", "axemastery", "Increases damage inflicted by axe and mace type weapons.  +2 per die per level."
createskill "Bow Mastery", "bowmastery", "Increases damage inflicted by bow type weapons.  +20% per level."
createskill "White Magic", "whitemagic", "Increases power of white spells and gives access to new white spells.  White spells focus on healing and protection."
createskill "Grey Magic", "greymagic", "Increases power of grey spells and gives access to new grey spells."
createskill "Fire Magic", "firemagic", "Increases power of fire spells and gives access to new fire spells.  Fire spells are largely offensive attack spells with a high damage rating."
createskill "Air Magic", "lightningmagic", "Increases power of air spells and gives access to new air spells.  Air magic gives good offensive spells with some basic defensive spells."
createskill "Water Magic", "watermagic", "Increases power of water spells and gives access to new water spells.  Water magic focuses on enchantment, healing, and exotic abilities."
createskill "Earth Magic", "earthmagic", "Increases power of earth spells and gives access to new earth spells.  Earth magic gives powerful defensive and combat abilities, but has no direct attack spells."
createskill "Demon Summoning", "demonsummoning", "Increases the power of summoned demons and gives you the ability to summon more."
createskill "Sorcery", "sorcery", "'Basic' magic.  Gives a broad range of spells and abilities that increase your magical powers."
'createskill "Magic Summoning", "magicsummoning", "Gives you the ability to summon a magical creature to aid you."

For a = 1 To 4
    Select Case chars(CurChar).combatskills(a)
        Case "Cripple": createskill "Cripple", "cripple", "Inflicts 25% damage on the first hit, +4% per level"
        Case "Frenzy": createskill "Frenzy", "frenzy", "Attacks 1 extra nearby enemy per level"
        Case "Split Spell": createskill "Split Spell", "splitspell", "Adds 80% to the mana cost of a spell and doubles the number of bolts it fires"
        Case "Stun": createskill "Stun", "stun", "Has a chance to stun enemies.  Increased skill increases chances and duration of stun."
        Case "Charged Strike": createskill "Charged Strike", "chargedstrike", "Adds 50% damage, +25% per level"
        Case "Power Strike": createskill "Power Strike", "powerstrike", "Adds (Strength times Weapon Dice times skill level) to damage"
        Case "Vital Strike": createskill "Vital Strike", "vitalstrike", "Adds (Dexterity times Weapon Dice times skill level) to damage"
        Case "Cunning Strike": createskill "Cunning Strike", "cunningstrike", "Adds (Intelligence times Weapon Dice times skill level) to damage"
        Case "Mana Shield": createskill "Mana Shield", "manashield", "Half damage is absorbed by mana, with a 10% reduction in damage taken to mana per level"
        Case "Block": createskill "Block", "block", "Damage reduced by 25%, +2% per level"
        Case "Damage Energy": createskill "Damage Energy", "damageenergy", "You get an amount of mana equal to 20% of the damage you take, +10% per level"
        Case "Poisonous": createskill "Poisonous", "poisonous", "Monsters take damage when they try to digest you"
        Case "Alchemy": createskill "Alchemy", "alchemy", "Gain three points of mana plus two per level every turn at the flat cost of 2 goldpieces per turn"
        Case "Split Arrow": createskill "Split Arrow", "splitarrow", "Fire one extra arrow per level"
        Case "Piercing Arrow": createskill "Piercing Arrow", "piercingarrow", "Arrows pierce up to 3 enemies, +1 per dice to damage per level"
        Case "Perfect Strike": createskill "Perfect Strike", "perfectstrike", "Attacks automatically inflict maximum damage, +5% per level."
        Case "Reflection": createskill "Reflection", "reflection", "Reflects weapons back at their firer, multiplying their damage by your level in the reflection skill."
        Case "Vicious": createskill "Vicious", "vicious", "Significantly increases damage against more dangerous enemies, based on your relative levels and the level of Vicious you have.  (Roughly +20%-30% per level they have over you, +15% per vicious level)"
    End Select
Next a


lastbutn = 6
    lastcbutn = 0

For a = 0 To lastskill - 1
    
    If ifclassskill(skilltree(a).skillname) = True Then
    butnarray(lastcbutn) = a
    createbutn a, Command1(lastcbutn): lastcbutn = lastcbutn + 1
    Else:
    butnarray(lastbutn) = a
    createbutn a, Command1(lastbutn): lastbutn = lastbutn + 1
    End If
'    lastbutn = a - 1
'    If chars(CurChar).classskills(a) = "" Then GoTo 5
'    For b = 0 To 50
'    If skilltree(b).skillname = chars(CurChar).classskills(a) Then createskill skilltree(b).skillname, skilltree(b).image, skilltree(b).caption, skilltree(b).requires, skilltree(b).requires2
'    Next b
Next a

Label2.caption = "Skill Points:" & chars(CurChar).skillpoints & vbCrLf & "Combat Skill Points:" & chars(CurChar).combatskillpoints


End Sub

Function createskill(skillname As String, Optional image As String = "", Optional caption As String = "", Optional requires As String = "", Optional requires2 As String = "")

'If ifclassskill(skillname) Then Exit Function

'butx = Int(lastbutn / 6) * 100 + 30
'buty = (lastbutn Mod 6) * 110 + 30
For a = 0 To 50
    If a > 0 And a <= 6 Then If plr.classskills(a) = skillname Then Exit For
    If a > 0 And a <= 4 Then If plr.combatskills(a) = skillname Then Exit For
    
    If plr.specials(a, 0) = skillname Then Exit For
Next a
If a = 51 Then Exit Function

skilltree(lastskill).skillname = skillname
skilltree(lastskill).image = image
skilltree(lastskill).requires = requires
skilltree(lastskill).requires2 = requires2
skilltree(lastskill).caption = caption

lastskill = lastskill + 1


End Function

Function createskill_new(skillname As String, Optional image As String = "", Optional caption As String = "", Optional requires As String = "", Optional requires2 As String = "")
'm'' this is the original Duam sub.
'If ifclassskill(skillname) Then Exit Function

'butx = Int(lastbutn / 6) * 100 + 30
'buty = (lastbutn Mod 6) * 110 + 30
For a = 0 To 50
    If a > 0 And a <= 6 Then If chars(CurChar).classskills(a) = skillname Then Exit For
    If a > 0 And a <= 4 Then If chars(CurChar).combatskills(a) = skillname Then Exit For
    
    If chars(CurChar).specials(a, 0) = skillname Then Exit For
Next a
If a = 51 Then Exit Function

skilltree(lastskill).skillname = skillname
skilltree(lastskill).image = image
skilltree(lastskill).requires = requires
skilltree(lastskill).requires2 = requires2
skilltree(lastskill).caption = caption

lastskill = lastskill + 1


End Function

Function createbutn(skillnum, butn As CommandButton)
skillname = skilltree(skillnum).skillname
wimage = skilltree(skillnum).image
If wimage = "" Then Exit Function
If Not Right(wimage, 3) = "jpg" Then wimage = "skillicon-" & wimage & ".jpg"
wimage = getfile(wimage)
butn.caption = skillname & " " & getplrskill(skillname)
butn.Picture = LoadPicture(wimage)
butn.Visible = True
'lastbutn = lastbutn + 1

End Function

Private Sub Command1_Click(Index As Integer)
Index2 = Index
Index = butnarray(Index)
If getplrskill(skilltree(Index).skillname, 0) > 10 Then Exit Sub
If skilltree(Index).skillname = "" Then Exit Sub

If iscombatskill(skilltree(Index).skillname) > 0 Then
If plr.combatskillpoints > 0 Then addskill skilltree(Index).skillname: plr.combatskillpoints = plr.combatskillpoints - 1
Command1(Index2).caption = skilltree(Index).skillname & " " & getplrskill(skilltree(Index).skillname)
Else:
If ifclassskill(skilltree(Index).skillname) = True Then cost = 3 + getplrskill(skilltree(Index).skillname, 0) Else cost = (3 + getplrskill(skilltree(Index).skillname, 0)) * 2

If plr.skillpoints < cost Then Exit Sub
addskill skilltree(Index).skillname

'Give/Upgrade spells according to skill
givespell skilltree(Index).skillname, "NONE", 0, getplrskill(skilltree(Index).skillname, 0)
Form1.updatspells

'Endurance HP Boost and Mana Mastery MP Boost
If skilltree(Index).skillname = "Endurance" And getplrskill("Endurance") = 1 Then plr.hpmax = plr.hpmax + skilltotal("Endurance", 2, 1) * plr.level
If skilltree(Index).skillname = "Mana Mastery" And getplrskill("Mana Mastery") = 1 Then plr.mpmax = plr.mpmax + skilltotal("Mana Mastery", 2, 1) * plr.level

If skilltree(Index).skillname = "Endurance" Then plr.hpmax = plr.hpmax + getplrskill("Endurance") * plr.level
If skilltree(Index).skillname = "Mana Mastery" Then plr.mpmax = plr.mpmax + getplrskill("Mana Mastery") * plr.level

plr.skillpoints = plr.skillpoints - cost
Command1(Index2).caption = skilltree(Index).skillname & " " & getplrskill(skilltree(Index).skillname)
End If


End Sub


Private Sub Command1_Click_new(Index As Integer)
'm'' this is the original Duam sub
Index2 = Index
Index = butnarray(Index)
If getplrskill(skilltree(Index).skillname, 0) > 10 Then Exit Sub
If skilltree(Index).skillname = "" Then Exit Sub

If iscombatskill(skilltree(Index).skillname) > 0 Then
If chars(CurChar).combatskillpoints > 0 Then addskill skilltree(Index).skillname: chars(CurChar).combatskillpoints = chars(CurChar).combatskillpoints - 1
Command1(Index2).caption = skilltree(Index).skillname & " " & getplrskill(skilltree(Index).skillname)
Else:
If ifclassskill(skilltree(Index).skillname) = True Then cost = 3 + getplrskill(skilltree(Index).skillname, 0) Else cost = (3 + getplrskill(skilltree(Index).skillname, 0)) * 2

If chars(CurChar).skillpoints < cost Then Exit Sub
addskill skilltree(Index).skillname

'Give/Upgrade spells according to skill
givespell skilltree(Index).skillname, "NONE", 0, getplrskill(skilltree(Index).skillname, 0)
Form1.updatspells

'Endurance HP Boost and Mana Mastery MP Boost
If skilltree(Index).skillname = "Endurance" And getplrskill("Endurance") = 1 Then chars(CurChar).hpmax = chars(CurChar).hpmax + skilltotal("Endurance", 2, 1) * chars(CurChar).level
If skilltree(Index).skillname = "Mana Mastery" And getplrskill("Mana Mastery") = 1 Then chars(CurChar).mpmax = chars(CurChar).mpmax + skilltotal("Mana Mastery", 2, 1) * chars(CurChar).level

If skilltree(Index).skillname = "Endurance" Then chars(CurChar).hpmax = chars(CurChar).hpmax + getplrskill("Endurance") * chars(CurChar).level
If skilltree(Index).skillname = "Mana Mastery" Then chars(CurChar).mpmax = chars(CurChar).mpmax + getplrskill("Mana Mastery") * chars(CurChar).level

chars(CurChar).skillpoints = chars(CurChar).skillpoints - cost
Command1(Index2).caption = skilltree(Index).skillname & " " & getplrskill(skilltree(Index).skillname)
End If


End Sub

Private Sub Command1_MouseMove(Index As Integer, Button As Integer, Shift As Integer, x As Single, y As Single)
Index = butnarray(Index)
If skilltree(Index).skillname = "" Then Exit Sub
Label1.caption = skilltree(Index).skillname & vbCrLf & "Current level:" & getplrskill(skilltree(Index).skillname) & vbCrLf & skilltree(Index).caption
'If getplrskill(skilltree(Index).skillname) > 0 Then
'Label1.caption = Label1.caption

If iscombatskill(skilltree(Index).skillname) = 0 Then If ifclassskill(skilltree(Index).skillname) = True Then Label1.caption = Label1.caption & vbCrLf & "This is a class skill for your character.  It will cost " & 3 + getplrskill(skilltree(Index).skillname, 0) & " to raise it." Else Label1.caption = Label1.caption & vbCrLf & "This is not a class skill for your character. It will cost " & (3 + getplrskill(skilltree(Index).skillname, 0)) * 2 & " to raise it."
If iscombatskill(skilltree(Index).skillname) > 0 Then Label1.caption = Label1.caption & vbCrLf & "This is a combat skill.  It requires one combat skill point to raise."

Label2.caption = "Skill Points:" & plr.skillpoints & vbCrLf & "Combat Skill Points:" & plr.combatskillpoints

End Sub

Private Sub Command1_MouseMove_new(Index As Integer, Button As Integer, Shift As Integer, x As Single, y As Single)
'm'' this is the original Duam sub

Index = butnarray(Index)
If skilltree(Index).skillname = "" Then Exit Sub
Label1.caption = skilltree(Index).skillname & vbCrLf & "Current level:" & getplrskill(skilltree(Index).skillname) & vbCrLf & skilltree(Index).caption
'If getplrskill(skilltree(Index).skillname) > 0 Then
'Label1.caption = Label1.caption

If iscombatskill(skilltree(Index).skillname) = 0 Then If ifclassskill(skilltree(Index).skillname) = True Then Label1.caption = Label1.caption & vbCrLf & "This is a class skill for your character.  It will cost " & 3 + getplrskill(skilltree(Index).skillname, 0) & " to raise it." Else Label1.caption = Label1.caption & vbCrLf & "This is not a class skill for your character. It will cost " & (3 + getplrskill(skilltree(Index).skillname, 0)) * 2 & " to raise it."
If iscombatskill(skilltree(Index).skillname) > 0 Then Label1.caption = Label1.caption & vbCrLf & "This is a combat skill.  It requires one combat skill point to raise."

Label2.caption = "Skill Points:" & chars(CurChar).skillpoints & vbCrLf & "Combat Skill Points:" & chars(CurChar).combatskillpoints

End Sub

Function getskillnum(skillname) As Byte

For a = 0 To 50

If skilltree(a).skillname = skillname Then getskillnum = a: Exit Function

Next a

End Function

Private Sub Form_Load()
updatbuttnz
End Sub
